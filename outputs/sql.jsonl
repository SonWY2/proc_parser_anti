{"type": "sql", "line_start": 68, "line_end": 68, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "initialize_system", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 72, "line_end": 72, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "initialize_system", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 77, "line_end": 77, "raw_content": "EXEC SQL CONNECT :username IDENTIFIED BY :password USING :db_string;", "function": "initialize_system", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL CONNECT :username IDENTIFIED BY :password USING :db_string;", "normalized_sql": "EXEC SQL CONNECT ? IDENTIFIED BY ? USING ?;", "input_host_vars": [":username", ":password", ":db_string"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 85, "line_end": 85, "raw_content": "EXEC SQL ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS';", "function": "initialize_system", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS';", "normalized_sql": "EXEC SQL ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI?';", "input_host_vars": [":SS"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 86, "line_end": 86, "raw_content": "EXEC SQL ALTER SESSION SET NLS_NUMERIC_CHARACTERS = '.,';", "function": "initialize_system", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL ALTER SESSION SET NLS_NUMERIC_CHARACTERS = '.,';", "normalized_sql": "EXEC SQL ALTER SESSION SET NLS_NUMERIC_CHARACTERS = '.,';", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 96, "line_end": 96, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "process_large_dataset", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 123, "line_end": 123, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "process_large_dataset", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 129, "line_end": 259, "raw_content": "EXEC SQL SELECT \n        e.employee_id,\n        e.first_name || ' ' || e.last_name AS full_name,\n        d.department_name,\n        e.salary,\n        TO_CHAR(e.hire_date, 'YYYY-MM-DD HH24:MI:SS') AS hire_date_str,\n        e.manager_id,\n        m.first_name || ' ' || m.last_name AS manager_full_name,\n        p.project_name,\n        p.budget AS project_budget,\n        c.customer_name,\n        (SELECT SUM(wh.hours_worked) \n         FROM work_hours wh \n         WHERE wh.employee_id = e.employee_id\n         AND wh.work_date >= TRUNC(SYSDATE, 'MONTH')) AS total_hours_this_month,\n        (SELECT AVG(pr.performance_rating)\n         FROM performance_reviews pr\n         WHERE pr.employee_id = e.employee_id\n         AND pr.review_date >= ADD_MONTHS(SYSDATE, -12)) AS avg_performance_score,\n        (SELECT MAX(pr2.review_date)\n         FROM performance_reviews pr2\n         WHERE pr2.employee_id = e.employee_id) AS last_review_date,\n        (SELECT COUNT(*)\n         FROM training_records tr\n         WHERE tr.employee_id = e.employee_id\n         AND tr.completion_date IS NOT NULL) AS training_completed,\n        (SELECT NVL(SUM(b.bonus_amount), 0)\n         FROM bonuses b\n         WHERE b.employee_id = e.employee_id\n         AND EXTRACT(YEAR FROM b.bonus_date) = EXTRACT(YEAR FROM SYSDATE)) AS ytd_bonus,\n        o.office_name || ', ' || o.city || ', ' || o.country AS office_location,\n        (SELECT COUNT(DISTINCT e2.employee_id)\n         FROM employees e2\n         WHERE e2.manager_id = e.employee_id) AS direct_reports,\n        (SELECT AVG(e3.salary)\n         FROM employees e3\n         WHERE e3.department_id = e.department_id) AS dept_average_salary,\n        (SELECT LISTAGG(s.skill_name, ', ') WITHIN GROUP (ORDER BY s.skill_name)\n         FROM employee_skills es\n         JOIN skills s ON es.skill_id = s.skill_id\n         WHERE es.employee_id = e.employee_id) AS skill_list,\n        (SELECT COUNT(*)\n         FROM certifications cert\n         WHERE cert.employee_id = e.employee_id\n         AND cert.expiry_date > SYSDATE) AS active_certifications,\n        ec.contact_name || ' (' || ec.relationship || ')' AS emergency_contact,\n        CASE \n            WHEN e.termination_date IS NOT NULL THEN 'TERMINATED'\n            WHEN e.on_leave = 'Y' THEN 'ON_LEAVE'\n            ELSE 'ACTIVE'\n        END AS employment_status,\n        (SELECT NVL(SUM(vd.days_taken), 0)\n         FROM vacation_days vd\n         WHERE vd.employee_id = e.employee_id\n         AND EXTRACT(YEAR FROM vd.start_date) = EXTRACT(YEAR FROM SYSDATE)) AS vacation_days_used,\n        (SELECT NVL(SUM(ot.hours), 0)\n         FROM overtime_log ot\n         WHERE ot.employee_id = e.employee_id\n         AND ot.overtime_date >= TRUNC(SYSDATE, 'MONTH')) AS overtime_hours_this_month,\n        (SELECT COUNT(DISTINCT pa.project_id)\n         FROM project_assignments pa\n         WHERE pa.employee_id = e.employee_id\n         AND pa.status = 'ACTIVE') AS active_project_count,\n        (SELECT NVL(SUM(rev.revenue_amount), 0)\n         FROM revenue_tracking rev\n         JOIN project_assignments pa2 ON rev.project_id = pa2.project_id\n         WHERE pa2.employee_id = e.employee_id\n         AND rev.revenue_date >= TRUNC(ADD_MONTHS(SYSDATE, -3), 'Q')) AS quarterly_revenue\n    INTO\n        :h_emp_id,\n        :h_emp_name,\n        :h_dept_name,\n        :h_salary,\n        :h_hire_date,\n        :h_manager_id,\n        :h_manager_name,\n        :h_project_name,\n        :h_project_budget,\n        :h_customer_name,\n        :h_total_hours,\n        :h_performance_score,\n        :h_last_review_date,\n        :h_training_count,\n        :h_bonus_amount,\n        :h_office_location,\n        :h_reports_count,\n        :h_dept_avg_salary,\n        :h_skill_list,\n        :h_certification_count,\n        :h_emergency_contact,\n        :h_status,\n        :h_vacation_days,\n        :h_overtime_hours,\n        :h_project_count,\n        :h_revenue_generated\n    FROM \n        employees e\n    INNER JOIN \n        departments d ON e.department_id = d.department_id\n    LEFT JOIN \n        employees m ON e.manager_id = m.employee_id\n    LEFT JOIN \n        project_assignments pa ON e.employee_id = pa.employee_id AND pa.is_primary = 'Y'\n    LEFT JOIN \n        projects p ON pa.project_id = p.project_id\n    LEFT JOIN \n        customers c ON p.customer_id = c.customer_id\n    LEFT JOIN \n        offices o ON e.office_id = o.office_id\n    LEFT JOIN \n        emergency_contacts ec ON e.employee_id = ec.employee_id AND ec.is_primary = 'Y'\n    WHERE \n        e.employee_id = :h_emp_id\n        AND e.status IN ('ACTIVE', 'ON_LEAVE')\n        AND d.department_id IN (\n            SELECT dept_id \n            FROM department_hierarchy \n            WHERE parent_dept_id IS NOT NULL\n            CONNECT BY PRIOR dept_id = parent_dept_id\n            START WITH dept_id = (SELECT department_id FROM employees WHERE employee_id = :h_emp_id)\n        )\n        AND EXISTS (\n            SELECT 1 \n            FROM work_hours wh2\n            WHERE wh2.employee_id = e.employee_id\n            AND wh2.work_date >= ADD_MONTHS(SYSDATE, -6)\n        )\n        AND e.hire_date < SYSDATE\n        AND (e.termination_date IS NULL OR e.termination_date > SYSDATE)\n    ORDER BY \n        e.employee_id;", "function": "process_large_dataset", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL SELECT \n        e.employee_id,\n        e.first_name || ' ' || e.last_name AS full_name,\n        d.department_name,\n        e.salary,\n        TO_CHAR(e.hire_date, 'YYYY-MM-DD HH24:MI:SS') AS hire_date_str,\n        e.manager_id,\n        m.first_name || ' ' || m.last_name AS manager_full_name,\n        p.project_name,\n        p.budget AS project_budget,\n        c.customer_name,\n        (SELECT SUM(wh.hours_worked) \n         FROM work_hours wh \n         WHERE wh.employee_id = e.employee_id\n         AND wh.work_date >= TRUNC(SYSDATE, 'MONTH')) AS total_hours_this_month,\n        (SELECT AVG(pr.performance_rating)\n         FROM performance_reviews pr\n         WHERE pr.employee_id = e.employee_id\n         AND pr.review_date >= ADD_MONTHS(SYSDATE, -12)) AS avg_performance_score,\n        (SELECT MAX(pr2.review_date)\n         FROM performance_reviews pr2\n         WHERE pr2.employee_id = e.employee_id) AS last_review_date,\n        (SELECT COUNT(*)\n         FROM training_records tr\n         WHERE tr.employee_id = e.employee_id\n         AND tr.completion_date IS NOT NULL) AS training_completed,\n        (SELECT NVL(SUM(b.bonus_amount), 0)\n         FROM bonuses b\n         WHERE b.employee_id = e.employee_id\n         AND EXTRACT(YEAR FROM b.bonus_date) = EXTRACT(YEAR FROM SYSDATE)) AS ytd_bonus,\n        o.office_name || ', ' || o.city || ', ' || o.country AS office_location,\n        (SELECT COUNT(DISTINCT e2.employee_id)\n         FROM employees e2\n         WHERE e2.manager_id = e.employee_id) AS direct_reports,\n        (SELECT AVG(e3.salary)\n         FROM employees e3\n         WHERE e3.department_id = e.department_id) AS dept_average_salary,\n        (SELECT LISTAGG(s.skill_name, ', ') WITHIN GROUP (ORDER BY s.skill_name)\n         FROM employee_skills es\n         JOIN skills s ON es.skill_id = s.skill_id\n         WHERE es.employee_id = e.employee_id) AS skill_list,\n        (SELECT COUNT(*)\n         FROM certifications cert\n         WHERE cert.employee_id = e.employee_id\n         AND cert.expiry_date > SYSDATE) AS active_certifications,\n        ec.contact_name || ' (' || ec.relationship || ')' AS emergency_contact,\n        CASE \n            WHEN e.termination_date IS NOT NULL THEN 'TERMINATED'\n            WHEN e.on_leave = 'Y' THEN 'ON_LEAVE'\n            ELSE 'ACTIVE'\n        END AS employment_status,\n        (SELECT NVL(SUM(vd.days_taken), 0)\n         FROM vacation_days vd\n         WHERE vd.employee_id = e.employee_id\n         AND EXTRACT(YEAR FROM vd.start_date) = EXTRACT(YEAR FROM SYSDATE)) AS vacation_days_used,\n        (SELECT NVL(SUM(ot.hours), 0)\n         FROM overtime_log ot\n         WHERE ot.employee_id = e.employee_id\n         AND ot.overtime_date >= TRUNC(SYSDATE, 'MONTH')) AS overtime_hours_this_month,\n        (SELECT COUNT(DISTINCT pa.project_id)\n         FROM project_assignments pa\n         WHERE pa.employee_id = e.employee_id\n         AND pa.status = 'ACTIVE') AS active_project_count,\n        (SELECT NVL(SUM(rev.revenue_amount), 0)\n         FROM revenue_tracking rev\n         JOIN project_assignments pa2 ON rev.project_id = pa2.project_id\n         WHERE pa2.employee_id = e.employee_id\n         AND rev.revenue_date >= TRUNC(ADD_MONTHS(SYSDATE, -3), 'Q')) AS quarterly_revenue\n    INTO\n        :h_emp_id,\n        :h_emp_name,\n        :h_dept_name,\n        :h_salary,\n        :h_hire_date,\n        :h_manager_id,\n        :h_manager_name,\n        :h_project_name,\n        :h_project_budget,\n        :h_customer_name,\n        :h_total_hours,\n        :h_performance_score,\n        :h_last_review_date,\n        :h_training_count,\n        :h_bonus_amount,\n        :h_office_location,\n        :h_reports_count,\n        :h_dept_avg_salary,\n        :h_skill_list,\n        :h_certification_count,\n        :h_emergency_contact,\n        :h_status,\n        :h_vacation_days,\n        :h_overtime_hours,\n        :h_project_count,\n        :h_revenue_generated\n    FROM \n        employees e\n    INNER JOIN \n        departments d ON e.department_id = d.department_id\n    LEFT JOIN \n        employees m ON e.manager_id = m.employee_id\n    LEFT JOIN \n        project_assignments pa ON e.employee_id = pa.employee_id AND pa.is_primary = 'Y'\n    LEFT JOIN \n        projects p ON pa.project_id = p.project_id\n    LEFT JOIN \n        customers c ON p.customer_id = c.customer_id\n    LEFT JOIN \n        offices o ON e.office_id = o.office_id\n    LEFT JOIN \n        emergency_contacts ec ON e.employee_id = ec.employee_id AND ec.is_primary = 'Y'\n    WHERE \n        e.employee_id = :h_emp_id\n        AND e.status IN ('ACTIVE', 'ON_LEAVE')\n        AND d.department_id IN (\n            SELECT dept_id \n            FROM department_hierarchy \n            WHERE parent_dept_id IS NOT NULL\n            CONNECT BY PRIOR dept_id = parent_dept_id\n            START WITH dept_id = (SELECT department_id FROM employees WHERE employee_id = :h_emp_id)\n        )\n        AND EXISTS (\n            SELECT 1 \n            FROM work_hours wh2\n            WHERE wh2.employee_id = e.employee_id\n            AND wh2.work_date >= ADD_MONTHS(SYSDATE, -6)\n        )\n        AND e.hire_date < SYSDATE\n        AND (e.termination_date IS NULL OR e.termination_date > SYSDATE)\n    ORDER BY \n        e.employee_id;", "normalized_sql": "EXEC SQL SELECT e.employee_id, e.first_name || ' ' || e.last_name AS full_name, d.department_name, e.salary, TO_CHAR(e.hire_date, 'YYYY-MM-DD HH24:MI?') AS hire_date_str, e.manager_id, m.first_name || ' ' || m.last_name AS manager_full_name, p.project_name, p.budget AS project_budget, c.customer_name, (SELECT SUM(wh.hours_worked) FROM work_hours wh WHERE wh.employee_id = e.employee_id AND wh.work_date >= TRUNC(SYSDATE, 'MONTH')) AS total_hours_this_month, (SELECT AVG(pr.performance_rating) FROM performance_reviews pr WHERE pr.employee_id = e.employee_id AND pr.review_date >= ADD_MONTHS(SYSDATE, -12)) AS avg_performance_score, (SELECT MAX(pr2.review_date) FROM performance_reviews pr2 WHERE pr2.employee_id = e.employee_id) AS last_review_date, (SELECT COUNT(*) FROM training_records tr WHERE tr.employee_id = e.employee_id AND tr.completion_date IS NOT NULL) AS training_completed, (SELECT NVL(SUM(b.bonus_amount), 0) FROM bonuses b WHERE b.employee_id = e.employee_id AND EXTRACT(YEAR FROM b.bonus_date) = EXTRACT(YEAR FROM SYSDATE)) AS ytd_bonus, o.office_name || ', ' || o.city || ', ' || o.country AS office_location, (SELECT COUNT(DISTINCT e2.employee_id) FROM employees e2 WHERE e2.manager_id = e.employee_id) AS direct_reports, (SELECT AVG(e3.salary) FROM employees e3 WHERE e3.department_id = e.department_id) AS dept_average_salary, (SELECT LISTAGG(s.skill_name, ', ') WITHIN GROUP (ORDER BY s.skill_name) FROM employee_skills es JOIN skills s ON es.skill_id = s.skill_id WHERE es.employee_id = e.employee_id) AS skill_list, (SELECT COUNT(*) FROM certifications cert WHERE cert.employee_id = e.employee_id AND cert.expiry_date > SYSDATE) AS active_certifications, ec.contact_name || ' (' || ec.relationship || ')' AS emergency_contact, CASE WHEN e.termination_date IS NOT NULL THEN 'TERMINATED' WHEN e.on_leave = 'Y' THEN 'ON_LEAVE' ELSE 'ACTIVE' END AS employment_status, (SELECT NVL(SUM(vd.days_taken), 0) FROM vacation_days vd WHERE vd.employee_id = e.employee_id AND EXTRACT(YEAR FROM vd.start_date) = EXTRACT(YEAR FROM SYSDATE)) AS vacation_days_used, (SELECT NVL(SUM(ot.hours), 0) FROM overtime_log ot WHERE ot.employee_id = e.employee_id AND ot.overtime_date >= TRUNC(SYSDATE, 'MONTH')) AS overtime_hours_this_month, (SELECT COUNT(DISTINCT pa.project_id) FROM project_assignments pa WHERE pa.employee_id = e.employee_id AND pa.status = 'ACTIVE') AS active_project_count, (SELECT NVL(SUM(rev.revenue_amount), 0) FROM revenue_tracking rev JOIN project_assignments pa2 ON rev.project_id = pa2.project_id WHERE pa2.employee_id = e.employee_id AND rev.revenue_date >= TRUNC(ADD_MONTHS(SYSDATE, -3), 'Q')) AS quarterly_revenue FROM employees e INNER JOIN departments d ON e.department_id = d.department_id LEFT JOIN employees m ON e.manager_id = m.employee_id LEFT JOIN project_assignments pa ON e.employee_id = pa.employee_id AND pa.is_primary = 'Y' LEFT JOIN projects p ON pa.project_id = p.project_id LEFT JOIN customers c ON p.customer_id = c.customer_id LEFT JOIN offices o ON e.office_id = o.office_id LEFT JOIN emergency_contacts ec ON e.employee_id = ec.employee_id AND ec.is_primary = 'Y' WHERE e.employee_id = ? AND e.status IN ('ACTIVE', 'ON_LEAVE') AND d.department_id IN ( SELECT dept_id FROM department_hierarchy WHERE parent_dept_id IS NOT NULL CONNECT BY PRIOR dept_id = parent_dept_id START WITH dept_id = (SELECT department_id FROM employees WHERE employee_id = ?) ) AND EXISTS ( SELECT 1 FROM work_hours wh2 WHERE wh2.employee_id = e.employee_id AND wh2.work_date >= ADD_MONTHS(SYSDATE, -6) ) AND e.hire_date < SYSDATE AND (e.termination_date IS NULL OR e.termination_date > SYSDATE) ORDER BY e.employee_id;", "input_host_vars": [":SS", ":h_emp_id", ":h_emp_id"], "output_host_vars": [":h_emp_id", ":h_emp_name", ":h_dept_name", ":h_salary", ":h_hire_date", ":h_manager_id", ":h_manager_name", ":h_project_name", ":h_project_budget", ":h_customer_name", ":h_total_hours", ":h_performance_score", ":h_last_review_date", ":h_training_count", ":h_bonus_amount", ":h_office_location", ":h_reports_count", ":h_dept_avg_salary", ":h_skill_list", ":h_certification_count", ":h_emergency_contact", ":h_status", ":h_vacation_days", ":h_overtime_hours", ":h_project_count", ":h_revenue_generated"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 273, "line_end": 273, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 282, "line_end": 282, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 289, "line_end": 320, "raw_content": "EXEC SQL DECLARE emp_details_cursor CURSOR FOR\n        SELECT \n            e.employee_id,\n            e.first_name || ' ' || e.last_name,\n            d.department_name,\n            e.salary,\n            e.department_id,\n            CASE \n                WHEN pa.status = 'ACTIVE' THEN 'IN_PROGRESS'\n                WHEN pa.status = 'COMPLETED' THEN 'DONE'\n                ELSE 'NOT_ASSIGNED'\n            END AS project_status,\n            NVL(SUM(wh.hours_worked), 0) AS total_hours,\n            TO_CHAR(MAX(wh.work_date), 'YYYY-MM-DD HH24:MI:SS') AS last_activity\n        FROM \n            employees e\n        JOIN \n            departments d ON e.department_id = d.department_id\n        LEFT JOIN \n            project_assignments pa ON e.employee_id = pa.employee_id\n        LEFT JOIN \n            work_hours wh ON e.employee_id = wh.employee_id\n        WHERE \n            e.status = 'ACTIVE'\n            AND d.budget > 100000\n        GROUP BY \n            e.employee_id, e.first_name, e.last_name, \n            d.department_name, e.salary, e.department_id, pa.status\n        HAVING \n            NVL(SUM(wh.hours_worked), 0) > 0\n        ORDER BY \n            e.salary DESC, e.employee_id;", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL DECLARE emp_details_cursor CURSOR FOR\n        SELECT \n            e.employee_id,\n            e.first_name || ' ' || e.last_name,\n            d.department_name,\n            e.salary,\n            e.department_id,\n            CASE \n                WHEN pa.status = 'ACTIVE' THEN 'IN_PROGRESS'\n                WHEN pa.status = 'COMPLETED' THEN 'DONE'\n                ELSE 'NOT_ASSIGNED'\n            END AS project_status,\n            NVL(SUM(wh.hours_worked), 0) AS total_hours,\n            TO_CHAR(MAX(wh.work_date), 'YYYY-MM-DD HH24:MI:SS') AS last_activity\n        FROM \n            employees e\n        JOIN \n            departments d ON e.department_id = d.department_id\n        LEFT JOIN \n            project_assignments pa ON e.employee_id = pa.employee_id\n        LEFT JOIN \n            work_hours wh ON e.employee_id = wh.employee_id\n        WHERE \n            e.status = 'ACTIVE'\n            AND d.budget > 100000\n        GROUP BY \n            e.employee_id, e.first_name, e.last_name, \n            d.department_name, e.salary, e.department_id, pa.status\n        HAVING \n            NVL(SUM(wh.hours_worked), 0) > 0\n        ORDER BY \n            e.salary DESC, e.employee_id;", "normalized_sql": "EXEC SQL DECLARE emp_details_cursor CURSOR FOR SELECT e.employee_id, e.first_name || ' ' || e.last_name, d.department_name, e.salary, e.department_id, CASE WHEN pa.status = 'ACTIVE' THEN 'IN_PROGRESS' WHEN pa.status = 'COMPLETED' THEN 'DONE' ELSE 'NOT_ASSIGNED' END AS project_status, NVL(SUM(wh.hours_worked), 0) AS total_hours, TO_CHAR(MAX(wh.work_date), 'YYYY-MM-DD HH24:MI?') AS last_activity FROM employees e JOIN departments d ON e.department_id = d.department_id LEFT JOIN project_assignments pa ON e.employee_id = pa.employee_id LEFT JOIN work_hours wh ON e.employee_id = wh.employee_id WHERE e.status = 'ACTIVE' AND d.budget > 100000 GROUP BY e.employee_id, e.first_name, e.last_name, d.department_name, e.salary, e.department_id, pa.status HAVING NVL(SUM(wh.hours_worked), 0) > 0 ORDER BY e.salary DESC, e.employee_id;", "input_host_vars": [":SS"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 323, "line_end": 323, "raw_content": "EXEC SQL OPEN emp_details_cursor;", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL OPEN emp_details_cursor;", "normalized_sql": "EXEC SQL OPEN emp_details_cursor;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 332, "line_end": 334, "raw_content": "EXEC SQL FETCH emp_details_cursor INTO \n            :c_emp_id, :c_emp_name, :c_dept, :c_salary,\n            :c_dept_id, :c_project_status, :c_hours_logged, :c_last_update;", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL FETCH emp_details_cursor INTO \n            :c_emp_id, :c_emp_name, :c_dept, :c_salary,\n            :c_dept_id, :c_project_status, :c_hours_logged, :c_last_update;", "normalized_sql": "EXEC SQL FETCH emp_details_cursor INTO ?, ?, ?, ?, ?, ?, ?, ?;", "input_host_vars": [":c_emp_id", ":c_emp_name", ":c_dept", ":c_salary", ":c_dept_id", ":c_project_status", ":c_hours_logged", ":c_last_update"], "output_host_vars": [":c_emp_id", ":c_emp_name", ":c_dept", ":c_salary", ":c_dept_id", ":c_project_status", ":c_hours_logged", ":c_last_update"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 357, "line_end": 362, "raw_content": "EXEC SQL INSERT INTO audit_log (\n                log_date, employee_id, action_type, description\n            ) VALUES (\n                SYSDATE, :c_emp_id, 'HIGH_SALARY_REVIEW',\n                'Employee flagged for high salary: ' || TO_CHAR(:c_salary)\n            );", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL INSERT INTO audit_log (\n                log_date, employee_id, action_type, description\n            ) VALUES (\n                SYSDATE, :c_emp_id, 'HIGH_SALARY_REVIEW',\n                'Employee flagged for high salary: ' || TO_CHAR(:c_salary)\n            );", "normalized_sql": "EXEC SQL INSERT INTO audit_log ( log_date, employee_id, action_type, description ) VALUES ( SYSDATE, ?, 'HIGH_SALARY_REVIEW', 'Employee flagged for high salary: ' || TO_CHAR(?) );", "input_host_vars": [":c_emp_id", ":c_salary"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 371, "line_end": 374, "raw_content": "EXEC SQL UPDATE overtime_tracking \n            SET flagged = 'Y', flag_date = SYSDATE\n            WHERE employee_id = :c_emp_id\n            AND EXTRACT(MONTH FROM work_date) = EXTRACT(MONTH FROM SYSDATE);", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL UPDATE overtime_tracking \n            SET flagged = 'Y', flag_date = SYSDATE\n            WHERE employee_id = :c_emp_id\n            AND EXTRACT(MONTH FROM work_date) = EXTRACT(MONTH FROM SYSDATE);", "normalized_sql": "EXEC SQL UPDATE overtime_tracking SET flagged = 'Y', flag_date = SYSDATE WHERE employee_id = ? AND EXTRACT(MONTH FROM work_date) = EXTRACT(MONTH FROM SYSDATE);", "input_host_vars": [":c_emp_id"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 379, "line_end": 379, "raw_content": "EXEC SQL CLOSE emp_details_cursor;", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL CLOSE emp_details_cursor;", "normalized_sql": "EXEC SQL CLOSE emp_details_cursor;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 384, "line_end": 402, "raw_content": "EXEC SQL DECLARE dept_summary_cursor CURSOR FOR\n        SELECT \n            d.department_id,\n            d.department_name,\n            COUNT(e.employee_id) AS emp_count,\n            AVG(e.salary) AS avg_salary,\n            SUM(e.salary) AS total_payroll,\n            MAX(e.salary) AS max_salary,\n            MIN(e.salary) AS min_salary\n        FROM \n            departments d\n        LEFT JOIN \n            employees e ON d.department_id = e.department_id\n        WHERE \n            d.status = 'ACTIVE'\n        GROUP BY \n            d.department_id, d.department_name\n        HAVING \n            COUNT(e.employee_id) > 0;", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL DECLARE dept_summary_cursor CURSOR FOR\n        SELECT \n            d.department_id,\n            d.department_name,\n            COUNT(e.employee_id) AS emp_count,\n            AVG(e.salary) AS avg_salary,\n            SUM(e.salary) AS total_payroll,\n            MAX(e.salary) AS max_salary,\n            MIN(e.salary) AS min_salary\n        FROM \n            departments d\n        LEFT JOIN \n            employees e ON d.department_id = e.department_id\n        WHERE \n            d.status = 'ACTIVE'\n        GROUP BY \n            d.department_id, d.department_name\n        HAVING \n            COUNT(e.employee_id) > 0;", "normalized_sql": "EXEC SQL DECLARE dept_summary_cursor CURSOR FOR SELECT d.department_id, d.department_name, COUNT(e.employee_id) AS emp_count, AVG(e.salary) AS avg_salary, SUM(e.salary) AS total_payroll, MAX(e.salary) AS max_salary, MIN(e.salary) AS min_salary FROM departments d LEFT JOIN employees e ON d.department_id = e.department_id WHERE d.status = 'ACTIVE' GROUP BY d.department_id, d.department_name HAVING COUNT(e.employee_id) > 0;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 404, "line_end": 404, "raw_content": "EXEC SQL OPEN dept_summary_cursor;", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL OPEN dept_summary_cursor;", "normalized_sql": "EXEC SQL OPEN dept_summary_cursor;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 406, "line_end": 406, "raw_content": "EXEC SQL CLOSE dept_summary_cursor;", "function": "handle_complex_cursors", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL CLOSE dept_summary_cursor;", "normalized_sql": "EXEC SQL CLOSE dept_summary_cursor;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 414, "line_end": 414, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "execute_batch_updates", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 420, "line_end": 420, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "execute_batch_updates", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 435, "line_end": 435, "raw_content": "EXEC SQL PREPARE update_stmt FROM :dyn_stmt;", "function": "execute_batch_updates", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL PREPARE update_stmt FROM :dyn_stmt;", "normalized_sql": "EXEC SQL PREPARE update_stmt FROM ?;", "input_host_vars": [":dyn_stmt"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 439, "line_end": 439, "raw_content": "EXEC SQL EXECUTE update_stmt USING :adjustment_factor, :i;", "function": "execute_batch_updates", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL EXECUTE update_stmt USING :adjustment_factor, :i;", "normalized_sql": "EXEC SQL EXECUTE update_stmt USING ?, ?;", "input_host_vars": [":adjustment_factor", ":i"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 445, "line_end": 445, "raw_content": "EXEC SQL COMMIT;", "function": "execute_batch_updates", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL COMMIT;", "normalized_sql": "EXEC SQL COMMIT;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 455, "line_end": 455, "raw_content": "EXEC SQL PREPARE history_stmt FROM :dyn_stmt;", "function": "execute_batch_updates", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL PREPARE history_stmt FROM :dyn_stmt;", "normalized_sql": "EXEC SQL PREPARE history_stmt FROM ?;", "input_host_vars": [":dyn_stmt"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 459, "line_end": 459, "raw_content": "EXEC SQL EXECUTE history_stmt USING :old_sal;", "function": "execute_batch_updates", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL EXECUTE history_stmt USING :old_sal;", "normalized_sql": "EXEC SQL EXECUTE history_stmt USING ?;", "input_host_vars": [":old_sal"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 462, "line_end": 462, "raw_content": "EXEC SQL COMMIT;", "function": "execute_batch_updates", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL COMMIT;", "normalized_sql": "EXEC SQL COMMIT;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 465, "line_end": 467, "raw_content": "EXEC SQL DELETE FROM temp_processing_log\n    WHERE process_date < SYSDATE - 30\n    AND status = 'COMPLETED';", "function": "execute_batch_updates", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL DELETE FROM temp_processing_log\n    WHERE process_date < SYSDATE - 30\n    AND status = 'COMPLETED';", "normalized_sql": "EXEC SQL DELETE FROM temp_processing_log WHERE process_date < SYSDATE - 30 AND status = 'COMPLETED';", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 477, "line_end": 477, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "generate_comprehensive_report", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 484, "line_end": 484, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "generate_comprehensive_report", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 489, "line_end": 504, "raw_content": "EXEC SQL SELECT \n        COUNT(*),\n        SUM(salary),\n        AVG(salary),\n        COUNT(DISTINCT department_id),\n        (SELECT COUNT(*) FROM projects WHERE status = 'ACTIVE'),\n        TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS')\n    INTO\n        :r_total_employees,\n        :r_total_payroll,\n        :r_avg_salary,\n        :r_dept_count,\n        :r_active_projects,\n        :r_report_date\n    FROM employees\n    WHERE status = 'ACTIVE';", "function": "generate_comprehensive_report", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL SELECT \n        COUNT(*),\n        SUM(salary),\n        AVG(salary),\n        COUNT(DISTINCT department_id),\n        (SELECT COUNT(*) FROM projects WHERE status = 'ACTIVE'),\n        TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS')\n    INTO\n        :r_total_employees,\n        :r_total_payroll,\n        :r_avg_salary,\n        :r_dept_count,\n        :r_active_projects,\n        :r_report_date\n    FROM employees\n    WHERE status = 'ACTIVE';", "normalized_sql": "EXEC SQL SELECT COUNT(*), SUM(salary), AVG(salary), COUNT(DISTINCT department_id), (SELECT COUNT(*) FROM projects WHERE status = 'ACTIVE'), TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI?') FROM employees WHERE status = 'ACTIVE';", "input_host_vars": [":SS"], "output_host_vars": [":r_total_employees", ":r_total_payroll", ":r_avg_salary", ":r_dept_count", ":r_active_projects", ":r_report_date"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 514, "line_end": 518, "raw_content": "EXEC SQL INSERT INTO system_reports (\n        report_type, report_date, total_emp, total_payroll, avg_salary\n    ) VALUES (\n        'MONTHLY_SUMMARY', SYSDATE, :r_total_employees, :r_total_payroll, :r_avg_salary\n    );", "function": "generate_comprehensive_report", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL INSERT INTO system_reports (\n        report_type, report_date, total_emp, total_payroll, avg_salary\n    ) VALUES (\n        'MONTHLY_SUMMARY', SYSDATE, :r_total_employees, :r_total_payroll, :r_avg_salary\n    );", "normalized_sql": "EXEC SQL INSERT INTO system_reports ( report_type, report_date, total_emp, total_payroll, avg_salary ) VALUES ( 'MONTHLY_SUMMARY', SYSDATE, ?, ?, ? );", "input_host_vars": [":r_total_employees", ":r_total_payroll", ":r_avg_salary"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 520, "line_end": 520, "raw_content": "EXEC SQL COMMIT;", "function": "generate_comprehensive_report", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL COMMIT;", "normalized_sql": "EXEC SQL COMMIT;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 531, "line_end": 531, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "validate_data_integrity", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 535, "line_end": 535, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "validate_data_integrity", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 540, "line_end": 544, "raw_content": "EXEC SQL SELECT COUNT(*) INTO :orphan_count\n    FROM employees e\n    WHERE NOT EXISTS (\n        SELECT 1 FROM departments d WHERE d.department_id = e.department_id\n    );", "function": "validate_data_integrity", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL SELECT COUNT(*) INTO :orphan_count\n    FROM employees e\n    WHERE NOT EXISTS (\n        SELECT 1 FROM departments d WHERE d.department_id = e.department_id\n    );", "normalized_sql": "EXEC SQL SELECT COUNT(*) FROM employees e WHERE NOT EXISTS ( SELECT 1 FROM departments d WHERE d.department_id = e.department_id );", "input_host_vars": [], "output_host_vars": [":orphan_count"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 551, "line_end": 557, "raw_content": "EXEC SQL SELECT COUNT(*) INTO :duplicate_count\n    FROM (\n        SELECT email, COUNT(*) as cnt\n        FROM employees\n        GROUP BY email\n        HAVING COUNT(*) > 1\n    );", "function": "validate_data_integrity", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL SELECT COUNT(*) INTO :duplicate_count\n    FROM (\n        SELECT email, COUNT(*) as cnt\n        FROM employees\n        GROUP BY email\n        HAVING COUNT(*) > 1\n    );", "normalized_sql": "EXEC SQL SELECT COUNT(*) FROM ( SELECT email, COUNT(*) as cnt FROM employees GROUP BY email HAVING COUNT(*) > 1 );", "input_host_vars": [], "output_host_vars": [":duplicate_count"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 564, "line_end": 566, "raw_content": "EXEC SQL SELECT COUNT(*) INTO :invalid_salary_count\n    FROM employees\n    WHERE salary < 0 OR salary > 1000000;", "function": "validate_data_integrity", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL SELECT COUNT(*) INTO :invalid_salary_count\n    FROM employees\n    WHERE salary < 0 OR salary > 1000000;", "normalized_sql": "EXEC SQL SELECT COUNT(*) FROM employees WHERE salary < 0 OR salary > 1000000;", "input_host_vars": [], "output_host_vars": [":invalid_salary_count"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 580, "line_end": 580, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "process_transactions", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 584, "line_end": 584, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "process_transactions", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 588, "line_end": 593, "raw_content": "EXEC SQL DECLARE trans_cursor CURSOR FOR\n        SELECT transaction_id, transaction_type, user_id\n        FROM transaction_log\n        WHERE transaction_date >= TRUNC(SYSDATE) - 7\n        AND status = 'PENDING'\n        ORDER BY transaction_id;", "function": "process_transactions", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL DECLARE trans_cursor CURSOR FOR\n        SELECT transaction_id, transaction_type, user_id\n        FROM transaction_log\n        WHERE transaction_date >= TRUNC(SYSDATE) - 7\n        AND status = 'PENDING'\n        ORDER BY transaction_id;", "normalized_sql": "EXEC SQL DECLARE trans_cursor CURSOR FOR SELECT transaction_id, transaction_type, user_id FROM transaction_log WHERE transaction_date >= TRUNC(SYSDATE) - 7 AND status = 'PENDING' ORDER BY transaction_id;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 595, "line_end": 595, "raw_content": "EXEC SQL OPEN trans_cursor;", "function": "process_transactions", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL OPEN trans_cursor;", "normalized_sql": "EXEC SQL OPEN trans_cursor;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 598, "line_end": 598, "raw_content": "EXEC SQL FETCH trans_cursor INTO :trans_id, :trans_type, :user_id;", "function": "process_transactions", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL FETCH trans_cursor INTO :trans_id, :trans_type, :user_id;", "normalized_sql": "EXEC SQL FETCH trans_cursor INTO ?, ?, ?;", "input_host_vars": [":trans_id", ":trans_type", ":user_id"], "output_host_vars": [":trans_id", ":trans_type", ":user_id"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 605, "line_end": 607, "raw_content": "EXEC SQL UPDATE transaction_log \n        SET status = 'PROCESSED', processed_date = SYSDATE\n        WHERE transaction_id = :trans_id;", "function": "process_transactions", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL UPDATE transaction_log \n        SET status = 'PROCESSED', processed_date = SYSDATE\n        WHERE transaction_id = :trans_id;", "normalized_sql": "EXEC SQL UPDATE transaction_log SET status = 'PROCESSED', processed_date = SYSDATE WHERE transaction_id = ?;", "input_host_vars": [":trans_id"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 610, "line_end": 610, "raw_content": "EXEC SQL CLOSE trans_cursor;", "function": "process_transactions", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL CLOSE trans_cursor;", "normalized_sql": "EXEC SQL CLOSE trans_cursor;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 611, "line_end": 611, "raw_content": "EXEC SQL COMMIT;", "function": "process_transactions", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL COMMIT;", "normalized_sql": "EXEC SQL COMMIT;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 622, "line_end": 622, "raw_content": "EXEC SQL COMMIT WORK;", "function": "cleanup_and_finalize", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL COMMIT WORK;", "normalized_sql": "EXEC SQL COMMIT WORK;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 625, "line_end": 627, "raw_content": "EXEC SQL INSERT INTO archived_logs\n    SELECT * FROM system_logs\n    WHERE log_date < SYSDATE - 90;", "function": "cleanup_and_finalize", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL INSERT INTO archived_logs\n    SELECT * FROM system_logs\n    WHERE log_date < SYSDATE - 90;", "normalized_sql": "EXEC SQL INSERT FROM system_logs WHERE log_date < SYSDATE - 90;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 629, "line_end": 630, "raw_content": "EXEC SQL DELETE FROM system_logs\n    WHERE log_date < SYSDATE - 90;", "function": "cleanup_and_finalize", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL DELETE FROM system_logs\n    WHERE log_date < SYSDATE - 90;", "normalized_sql": "EXEC SQL DELETE FROM system_logs WHERE log_date < SYSDATE - 90;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 632, "line_end": 632, "raw_content": "EXEC SQL COMMIT;", "function": "cleanup_and_finalize", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL COMMIT;", "normalized_sql": "EXEC SQL COMMIT;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 635, "line_end": 635, "raw_content": "EXEC SQL COMMIT WORK RELEASE;", "function": "cleanup_and_finalize", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL COMMIT WORK RELEASE;", "normalized_sql": "EXEC SQL COMMIT WORK RELEASE;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 10, "line_end": 10, "raw_content": "EXEC SQL SELECT * FROM ignored;", "function": null, "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL SELECT * FROM ignored;", "normalized_sql": "EXEC SQL SELECT * FROM ignored;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 25, "line_end": 25, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "complex_function", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 28, "line_end": 28, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "complex_function", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 31, "line_end": 43, "raw_content": "EXEC SQL \n        SELECT \n            /* Comment inside SQL */\n            name, \n            salary -- Single line comment inside SQL\n        INTO \n            :emp_struct.name, \n            :emp_ids[0] \n        FROM \n            emp \n        WHERE \n            id = :h_id \n            AND created_at > TO_DATE('2023-01-01 12:00:00', 'YYYY-MM-DD HH24:MI:SS');", "function": "complex_function", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL \n        SELECT \n            /* Comment inside SQL */\n            name, \n            salary -- Single line comment inside SQL\n        INTO \n            :emp_struct.name, \n            :emp_ids[0] \n        FROM \n            emp \n        WHERE \n            id = :h_id \n            AND created_at > TO_DATE('2023-01-01 12:00:00', 'YYYY-MM-DD HH24:MI:SS');", "normalized_sql": "EXEC SQL SELECT /* Comment inside SQL */ name, salary -- Single line comment inside SQL FROM emp WHERE id = ? AND created_at > TO_DATE('2023-01-01 12:00:00', 'YYYY-MM-DD HH24:MI?');", "input_host_vars": [":h_id", ":SS"], "output_host_vars": [":emp_struct", ":emp_ids"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 49, "line_end": 49, "raw_content": "EXEC SQL PREPARE s2 FROM :dyn_stmt;", "function": "complex_function", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL PREPARE s2 FROM :dyn_stmt;", "normalized_sql": "EXEC SQL PREPARE s2 FROM ?;", "input_host_vars": [":dyn_stmt"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 50, "line_end": 50, "raw_content": "EXEC SQL EXECUTE s2;", "function": "complex_function", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL EXECUTE s2;", "normalized_sql": "EXEC SQL EXECUTE s2;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 58, "line_end": 58, "raw_content": "EXEC SQL COMMIT;", "function": "complex_function", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL COMMIT;", "normalized_sql": "EXEC SQL COMMIT;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 8, "line_end": 8, "raw_content": "EXEC SQL INCLUDE sqlca;", "function": null, "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL INCLUDE sqlca;", "normalized_sql": "EXEC SQL INCLUDE sqlca;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 23, "line_end": 23, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "db_connect", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 26, "line_end": 26, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "db_connect", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 28, "line_end": 28, "raw_content": "EXEC SQL CONNECT :username IDENTIFIED BY :password;", "function": "db_connect", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL CONNECT :username IDENTIFIED BY :password;", "normalized_sql": "EXEC SQL CONNECT ? IDENTIFIED BY ?;", "input_host_vars": [":username", ":password"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 33, "line_end": 33, "raw_content": "EXEC SQL BEGIN DECLARE SECTION;", "function": "process_employee", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL BEGIN DECLARE SECTION;", "normalized_sql": "EXEC SQL BEGIN DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 38, "line_end": 38, "raw_content": "EXEC SQL END DECLARE SECTION;", "function": "process_employee", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL END DECLARE SECTION;", "normalized_sql": "EXEC SQL END DECLARE SECTION;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 43, "line_end": 46, "raw_content": "EXEC SQL SELECT name, salary \n             INTO :h_name, :h_salary \n             FROM emp \n             WHERE id = :h_id;", "function": "process_employee", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL SELECT name, salary \n             INTO :h_name, :h_salary \n             FROM emp \n             WHERE id = :h_id;", "normalized_sql": "EXEC SQL SELECT name, salary FROM emp WHERE id = ?;", "input_host_vars": [":h_id"], "output_host_vars": [":h_name", ":h_salary"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 54, "line_end": 54, "raw_content": "EXEC SQL PREPARE s1 FROM :stmt;", "function": "process_employee", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL PREPARE s1 FROM :stmt;", "normalized_sql": "EXEC SQL PREPARE s1 FROM ?;", "input_host_vars": [":stmt"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 55, "line_end": 55, "raw_content": "EXEC SQL EXECUTE s1 USING :h_id;", "function": "process_employee", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL EXECUTE s1 USING :h_id;", "normalized_sql": "EXEC SQL EXECUTE s1 USING ?;", "input_host_vars": [":h_id"], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 58, "line_end": 59, "raw_content": "EXEC SQL DECLARE emp_cursor CURSOR FOR \n        SELECT id, name FROM emp WHERE salary > 5000;", "function": "process_employee", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL DECLARE emp_cursor CURSOR FOR \n        SELECT id, name FROM emp WHERE salary > 5000;", "normalized_sql": "EXEC SQL DECLARE emp_cursor CURSOR FOR SELECT id, name FROM emp WHERE salary > 5000;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 61, "line_end": 61, "raw_content": "EXEC SQL OPEN emp_cursor;", "function": "process_employee", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL OPEN emp_cursor;", "normalized_sql": "EXEC SQL OPEN emp_cursor;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 64, "line_end": 64, "raw_content": "EXEC SQL FETCH emp_cursor INTO :h_id, :h_name;", "function": "process_employee", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL FETCH emp_cursor INTO :h_id, :h_name;", "normalized_sql": "EXEC SQL FETCH emp_cursor INTO ?, ?;", "input_host_vars": [":h_id", ":h_name"], "output_host_vars": [":h_id", ":h_name"], "dynamic_sql_stmt": null}
{"type": "sql", "line_start": 69, "line_end": 69, "raw_content": "EXEC SQL CLOSE emp_cursor;", "function": "process_employee", "sql_type": "UNKNOWN", "raw_sql": "EXEC SQL CLOSE emp_cursor;", "normalized_sql": "EXEC SQL CLOSE emp_cursor;", "input_host_vars": [], "output_host_vars": [], "dynamic_sql_stmt": null}
